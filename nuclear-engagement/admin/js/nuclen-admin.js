import{e as d,w as V,l as O}from"../../logger-DwRZMuf8.js";const _={RETRY_COUNT:3,INITIAL_DELAY_MS:500,POLLING_INTERVAL_MS:1e4,MAX_BACKOFF_MS:3e4,POLLING_INTERVALS:[{duration:6e4,interval:1e4},{duration:24e4,interval:3e4},{duration:1/0,interval:6e4}],MAX_POLLING_ATTEMPTS:240,MAX_POLLING_TIMEOUT_MS:18e5};async function C(e,t,n=_.RETRY_COUNT,o=_.INITIAL_DELAY_MS,a=3e4){let r=0,s=o,c;for(;r<=n;){try{const i=new window.AbortController,l=setTimeout(()=>i.abort(),a),f=await fetch(e,{...t,signal:i.signal});clearTimeout(l);const{status:p,ok:w}=f,m=await f.text().catch(()=>"");let u=null;if(m)try{u=JSON.parse(m)}catch{}return w?{ok:!0,status:p,data:u}:{ok:!1,status:p,data:u,error:m}}catch(i){if(c=i,c.name==="AbortError"&&(c=new Error(`Request timeout after ${a}ms`)),r===n)break;V(`[RETRY] API request | URL: ${e} | Method: ${t.method||"GET"} | Attempts left: ${n-r} | Error: ${c.message}`),await new Promise(l=>setTimeout(l,s)),s=Math.min(s*2,_.MAX_BACKOFF_MS)}r+=1}throw d(`[ERROR] Max retries exhausted | URL: ${e} | Method: ${t.method||"GET"} | Error: ${(c==null?void 0:c.message)||"Unknown error"}`),c}async function Y(e){if(!window.nuclenAjax||!window.nuclenAjax.ajax_url||!window.nuclenAjax.fetch_action){const o=new Error("[ERROR] Missing configuration | Required: nuclenAjax.ajax_url and nuclenAjax.fetch_action");throw d(o.message),o}const t=new FormData;t.append("action",window.nuclenAjax.fetch_action),window.nuclenAjax.nonce&&t.append("security",window.nuclenAjax.nonce),e&&t.append("generation_id",e);const n=await C(window.nuclenAjax.ajax_url,{method:"POST",body:t,credentials:"same-origin"},_.RETRY_COUNT,_.INITIAL_DELAY_MS,1e4);if(!n.ok){const o=n.error||"Unknown error";if(o.includes("Polling failed after")&&o.includes("attempts"))return{success:!1,message:o,data:{processed:0,total:0,workflow:"unknown"}};const a=new Error(`[ERROR] Fetch updates failed | Status: ${n.status} | Error: ${o}`);throw d(a.message),a}return n.data}async function G(e){var r;if(!window.nuclenAdminVars||!window.nuclenAdminVars.ajax_url){const s=new Error("[ERROR] Missing configuration | Required: nuclenAdminVars.ajax_url");throw d(s.message),s}const t=new FormData;if(t.append("action","nuclen_trigger_generation"),t.append("payload",JSON.stringify(e)),!((r=window.nuclenAjax)!=null&&r.nonce)){const s=new Error("[ERROR] Security check failed | Missing nonce");throw d(s.message),s}t.append("security",window.nuclenAjax.nonce);const n=await C(window.nuclenAdminVars.ajax_url,{method:"POST",body:t,credentials:"same-origin"},_.RETRY_COUNT,_.INITIAL_DELAY_MS,6e4);if(!n.ok){const s=new Error(`[ERROR] Generation start failed | Status: ${n.status} | Error: ${n.error||"Unknown error"}`);throw d(s.message),s}const o=n.data;if(!o||typeof o!="object"){const s=new Error("[ERROR] Invalid response | Expected object, received: "+typeof o);throw d(s.message),s}let a;if("success"in o&&typeof o.success=="boolean"?a=o:a={success:!0,data:o},!a.success){let s="Unknown error";a.message?s=a.message:a.data&&typeof a.data=="object"&&a.data.message&&(s=a.data.message);const c=new Error(`[ERROR] Generation start failed | Error: ${s}`);throw d(c.message),c}return a}function M({intervalMs:e=_.POLLING_INTERVAL_MS,generationId:t,onProgress:n=()=>{},onComplete:o=()=>{},onError:a=()=>{},maxAttempts:r=_.MAX_POLLING_ATTEMPTS,timeoutMs:s=_.MAX_POLLING_TIMEOUT_MS,useExponentialBackoff:c=!1,maxIntervalMs:i=6e4,useProgressiveIntervals:l=!0}){if(!t||t.trim()==="")return d("[ERROR] Polling failed | Missing generation ID"),a("No generation ID provided for polling"),()=>{};let f=0;const p=Date.now();let w=e,m=0,u=null;const E=L=>{if(!l)return e;let h=0;for(const b of _.POLLING_INTERVALS){if(L<h+b.duration)return b.interval;h+=b.duration}return _.POLLING_INTERVALS[_.POLLING_INTERVALS.length-1].interval},T=()=>{u&&clearTimeout(u);const L=Date.now()-p;l?w=E(L):c&&m>0&&(w=Math.min(e*Math.pow(1.5,m),i)),u=setTimeout(A,w)},A=async()=>{f++;const L=Date.now()-p;if(f>r){u&&clearTimeout(u),a(`polling-timeout:${t}`);return}if(L>s){u&&clearTimeout(u),a(`polling-timeout:${t}`);return}try{const h=await Y(t);if(!h.success){const k=h.message||"Failed to fetch updates. The task may have been cancelled, or there has been an error. Please see the log file on the setup page or contact support.";if(k.includes("Task has been cancelled")||k.includes("cancelled")){u&&clearTimeout(u),O(`[INFO] Task cancelled | GenID: ${t}`),a(`task-cancelled:${t}`);return}if(k.includes("Polling failed after")&&k.includes("attempts")){u&&clearTimeout(u),a(`polling-timeout:${t}`);return}throw d(`[ERROR] Poll failed | GenID: ${t} | Error: ${k}`),new Error(k)}m=0,w=e;const{processed:b,total:P,successCount:R=b,failCount:$,finalReport:D,results:U,workflow:q}=h.data;O(`[DEBUG] Poll progress | GenID: ${t} | Progress: ${b}/${P} | Success: ${R} | Failed: ${$||0}`),n(b,P,h.data),b>=P?(u&&clearTimeout(u),O(`[SUCCESS] Polling complete | GenID: ${t} | Total: ${P} | Success: ${R} | Failed: ${$||0}`),o({processed:b,total:P,successCount:R,failCount:$,finalReport:D,results:U,workflow:q})):T()}catch(h){if(m++,m>=3){u&&clearTimeout(u);const b=h instanceof Error?h.message:"Unknown error";d(`[ERROR] Polling failed | GenID: ${t} | Attempts: ${f} | Consecutive errors: ${m} | Error: ${b}`),a(`polling-error:${t}`)}else h instanceof Error&&h.message,T()}};return A(),()=>{u&&clearTimeout(u)}}function y(e,t){d(`[ERROR] UI Error | ${e}`);const n=document.createElement("div");n.className="nuclen-error-toast",n.innerHTML=e,document.body.appendChild(n),setTimeout(()=>{n.parentNode&&n.remove()},5e3)}var j;const W=((j=window.nuclenAdminVars)==null?void 0:j.rest_receive_content)||"/wp-json/nuclear-engagement/v1/receive-content";var F;const z=((F=window.nuclenAdminVars)==null?void 0:F.rest_nonce)||"";function x(e){var n;const t=e.replace(/<[^>]+>/g,"");if(t.includes("task-cancelled:")||t.includes("Task has been cancelled")){let o="";if(e.includes("task-cancelled:")){const a=e.split(":");a.length>1&&(o=a[1])}y("Task has been cancelled. Redirecting to tasks page..."),setTimeout(()=>{var r;const a=`${((r=window.nuclenAdminVars)==null?void 0:r.admin_url)||"/wp-admin/"}admin.php?page=nuclear-engagement-tasks${o?"&highlight="+o:""}`;window.location.href=a},2e3);return}if(t.includes("Polling failed after")||t.includes("Polling error")||t.includes("Failed to fetch updates")||t.includes("polling-timeout:")||t.includes("polling-error:")){let o="";if(e.includes("polling-timeout:")||e.includes("polling-error:")){const r=e.split(":");r.length>1&&(o=r[1])}const a=`${((n=window.nuclenAdminVars)==null?void 0:n.admin_url)||"/wp-admin/"}admin.php?page=nuclear-engagement-tasks${o?"&highlight="+o:""}`;window.location.href=a;return}t.includes("Invalid API key")?y("Your API key is invalid. Please go to the Setup page and enter a new one."):t.includes("Invalid WP App Password")?y("Your WP App Password is invalid. Please re-generate it on the Setup page."):t.includes("Not enough credits")?y("Not enough credits. Please top up your account or reduce the number of posts."):y(`Error: ${t}`)}async function X(e,t){const n={workflow:e,results:t};let o;try{o=await fetch(W,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":z},credentials:"include",body:JSON.stringify(n)})}catch(r){return d("Fetch failed in nuclenStoreGenerationResults:",r),y("Network error"),{ok:!1,data:{message:"Network error"}}}let a=null;if(o.ok)try{a=await o.json()}catch{return{ok:!1,data:{message:"Invalid JSON"}}}return{ok:o.ok,data:a}}function H(e,t){const{date:n,questions:o}=e,a=t||n,r=document.querySelector('input[name="nuclen_quiz_data[date]"]');r&&(r.readOnly=!1,r.value=a||"",r.readOnly=!0),Array.isArray(o)&&o.forEach((s,c)=>{const i=`input[name="nuclen_quiz_data[questions][${c}][question]"]`,l=document.querySelector(i);l&&(l.value=s.question||""),Array.isArray(s.answers)&&s.answers.forEach((w,m)=>{const u=`input[name="nuclen_quiz_data[questions][${c}][answers][${m}]"]`,E=document.querySelector(u);E&&(E.value=w)});const f=`textarea[name="nuclen_quiz_data[questions][${c}][explanation]"]`,p=document.querySelector(f);p&&(p.value=s.explanation||"")})}function J(e,t){var s;const{date:n,summary:o}=e,a=t||n,r=document.querySelector('input[name="nuclen_summary_data[date]"]');if(r&&(r.readOnly=!1,r.value=a||"",r.readOnly=!0),typeof window.tinymce<"u"){const c=window.tinymce;let i;if(typeof c.get=="function"&&(i=c.get("nuclen_summary_data_summary")),i&&typeof i.setContent=="function")i.setContent(o||""),(s=i.save)==null||s.call(i);else{const l=document.querySelector('textarea[name="nuclen_summary_data[summary]"]');l&&(l.value=o||"")}}else{const c=document.querySelector('textarea[name="nuclen_summary_data[summary]"]');c&&(c.value=o||"")}}const S=new Map;function Q(){document.addEventListener("click",async e=>{var c;const t=e.target;if(!(t instanceof HTMLElement)||!t.classList.contains("nuclen-generate-single"))return;const n=t,o=n.dataset.postId,a=n.dataset.workflow;if(!o||!a){y("Missing data attributes: postId or workflow not found.");return}const r=`${o}-${a}`,s=S.get(r);s&&(s(),S.delete(r)),n.disabled=!0,n.textContent="Generating...";try{const i=await G({nuclen_selected_post_ids:JSON.stringify([o]),nuclen_selected_generate_workflow:a});if("ok"in i&&!i.ok){x(i.error||"Generation failed"),n.textContent="Generate",n.disabled=!1;return}const l=((c=i.data)==null?void 0:c.generation_id)||i.generation_id||"gen_"+Math.random().toString(36).substring(2),f=M({intervalMs:5e3,generationId:l,onProgress(){n.textContent="Generating..."},async onComplete({results:p,workflow:w}){if(S.delete(r),p&&typeof p=="object")try{const{ok:m,data:u}=await X(w,p),E=u;if(m&&!("code"in E)){const T=p[o],A=E.finalDate&&typeof E.finalDate=="string"?E.finalDate:void 0;T&&(w==="quiz"?H(T,A):w==="summary"&&J(T,A)),n.textContent="Stored!"}else d("Error storing single-generation results in WP:",E),n.textContent="Generation failed!"}catch(m){d("Fetch error calling /receive-content endpoint:",m),n.textContent="Generation failed!"}else n.textContent="Done (no data)!";n.disabled=!1},onError(p){var w;if(S.delete(r),p.startsWith("polling-timeout:")||p.startsWith("polling-error:")){const m=p.split(":")[1];window.location.href=`${((w=window.nuclenAdminVars)==null?void 0:w.admin_url)||"/wp-admin/"}admin.php?page=nuclear-engagement-tasks&highlight=${m}`}else x(p),n.textContent="Generate",n.disabled=!1}});S.set(r,f)}catch(i){const l=i instanceof Error?i.message:"Unknown error";x(l),n.textContent="Generate",n.disabled=!1}}),window.addEventListener("beforeunload",()=>{S.forEach(e=>e()),S.clear()})}Q();function K(){return{step1:document.getElementById("nuclen-step-1"),step2:document.getElementById("nuclen-step-2"),updatesSection:document.getElementById("nuclen-updates-section"),updatesContent:document.getElementById("nuclen-updates-content"),restartBtn:document.getElementById("nuclen-restart-btn"),getPostsBtn:document.getElementById("nuclen-get-posts-btn"),goBackBtn:document.getElementById("nuclen-go-back-btn"),generateForm:document.getElementById("nuclen-generate-form"),submitBtn:document.getElementById("nuclen-submit-btn"),postsCountEl:document.getElementById("nuclen-posts-count"),stepBar1:document.getElementById("nuclen-step-bar-1"),stepBar2:document.getElementById("nuclen-step-bar-2"),stepBar3:document.getElementById("nuclen-step-bar-3"),stepBar4:document.getElementById("nuclen-step-bar-4"),creditsInfoEl:document.getElementById("nuclen-credits-info")}}function I(e){e&&e.classList.remove("nuclen-hidden")}function v(e){e&&e.classList.add("nuclen-hidden")}function g(e,t){e&&(e.classList.remove("ne-step-bar__step--todo","ne-step-bar__step--current","ne-step-bar__step--done","ne-step-bar__step--failed"),e.classList.add(`ne-step-bar__step--${t}`))}async function Z(){var o;if(!window.nuclenAjax||!window.nuclenAjax.ajax_url)throw new Error("Missing nuclenAjax configuration (ajax_url).");if(!window.nuclenAjax.fetch_action)throw new Error("Missing fetch_action in nuclenAjax configuration.");const e=new FormData;e.append("action",window.nuclenAjax.fetch_action),window.nuclenAjax.nonce&&e.append("security",window.nuclenAjax.nonce);const t=await C(window.nuclenAjax.ajax_url,{method:"POST",body:e,credentials:"same-origin"});if(!t.ok)throw new Error(t.error||`HTTP ${t.status}`);const n=t.data;if(!n.success)throw new Error(n.message||((o=n.data)==null?void 0:o.message)||"Failed to fetch credits from SaaS");if(typeof n.data.remaining_credits=="number")return n.data.remaining_credits;throw new Error("No 'remaining_credits' in response")}function N(){const e=document.getElementById("nuclen_generate_workflow"),t=document.getElementById("nuclen-summary-settings"),n=document.getElementById("nuclen-summary-paragraph-options"),o=document.getElementById("nuclen-summary-bullet-options"),a=document.getElementById("nuclen_summary_format");!e||!t||!n||!o||!a||(e.value==="summary"?(t.classList.remove("nuclen-hidden"),a.value==="paragraph"?(n.classList.remove("nuclen-hidden"),o.classList.add("nuclen-hidden")):(n.classList.add("nuclen-hidden"),o.classList.remove("nuclen-hidden"))):(t.classList.add("nuclen-hidden"),n.classList.add("nuclen-hidden"),o.classList.add("nuclen-hidden")))}function ee(){const e=document.getElementById("nuclen_post_status"),t=document.getElementById("nuclen_category"),n=document.getElementById("nuclen_author"),o=document.getElementById("nuclen_post_type"),a=document.getElementById("nuclen_generate_workflow"),r=document.getElementById("nuclen_allow_regenerate_data"),s=document.getElementById("nuclen_regenerate_protected_data"),c=document.getElementById("nuclen_summary_format"),i=document.getElementById("nuclen_summary_length"),l=document.getElementById("nuclen_summary_number_of_items");return{postStatus:e?e.value:"",category:t?t.value:"",author:n?n.value:"",postType:o?o.value:"",workflow:a?a.value:"",allowRegenerate:!!r&&r.checked,regenerateProtected:!!s&&s.checked,summaryFormat:c?c.value:"",summaryLength:i?i.value:"",summaryNumberOfItems:l?l.value:""}}function te(e,t){e.append("nuclen_post_status",t.postStatus),e.append("nuclen_category",t.category),e.append("nuclen_author",t.author),e.append("nuclen_post_type",t.postType),e.append("nuclen_generate_workflow",t.workflow),e.append("nuclen_allow_regenerate_data",t.allowRegenerate?"1":"0"),e.append("nuclen_regenerate_protected_data",t.regenerateProtected?"1":"0"),e.append("nuclen_summary_format",t.summaryFormat),e.append("nuclen_summary_length",t.summaryLength),e.append("nuclen_summary_number_of_items",t.summaryNumberOfItems)}function ne(e){const t=document.getElementById("nuclen_selected_generate_workflow"),n=document.getElementById("nuclen_selected_summary_format"),o=document.getElementById("nuclen_selected_summary_length"),a=document.getElementById("nuclen_selected_summary_number_of_items"),r=document.getElementById("nuclen_selected_post_status"),s=document.getElementById("nuclen_selected_post_type");t&&(t.value=e.workflow),n&&(n.value=e.summaryFormat),o&&(o.value=e.summaryLength),a&&(a.value=e.summaryNumberOfItems),r&&(r.value=e.postStatus),s&&(s.value=e.postType)}async function oe(e,t){var a;const n=new FormData;n.append("action","nuclen_get_posts_count"),(a=window.nuclenAjax)!=null&&a.nonce&&n.append("security",window.nuclenAjax.nonce),te(n,t);const o=await C(e,{method:"POST",body:n,credentials:"same-origin"});return o.ok?o.data:null}async function ae(e,t){try{const n=await Z(),o=t;e.creditsInfoEl&&(e.creditsInfoEl.textContent=`This will consume ${o} credit(s). You have ${n} left.`),n<o?(y("Not enough credits. Please top up or reduce the number of posts."),e.submitBtn&&(e.submitBtn.disabled=!0)):e.submitBtn&&(I(e.submitBtn),e.submitBtn.disabled=!1)}catch(n){d("Error fetching remaining credits:",n);const o=n instanceof Error?n.message:"Unknown error";e.creditsInfoEl&&(e.creditsInfoEl.textContent=`Unable to retrieve your credits: ${o}`),e.submitBtn&&v(e.submitBtn)}}function re(e){var t;(t=e.getPostsBtn)==null||t.addEventListener("click",async()=>{var c;if(!window.nuclenAjax||!window.nuclenAjax.ajax_url){y("Error: Ajax is not configured properly. Please check the plugin settings.");return}e.postsCountEl&&(e.postsCountEl.innerText="Loading posts...");const n=ee(),o=await oe(window.nuclenAjax.ajax_url||"",n);if(!o){d("Error retrieving post count"),e.postsCountEl&&(e.postsCountEl.innerText="Error retrieving post count.");return}if(!o.success){e.postsCountEl&&(e.postsCountEl.innerText="Error retrieving post count.");const i=o.message||((c=o.data)==null?void 0:c.message);i&&(i.includes("Invalid API key")?y("Your Gold Code (API key) is invalid. Please create a new one on the NE app and enter it on the plugin Setup page."):i.includes("Invalid WP App Password")?y("Your WP App Password is invalid. Please go to the plugin Setup page and re-generate it."):y(i));return}const a=o.data.count,r=o.data.post_ids,s=document.getElementById("nuclen_selected_post_ids");if(s&&(s.value=JSON.stringify(r)),ne(n),v(e.step1),I(e.step2),g(e.stepBar1,"done"),g(e.stepBar2,"current"),a===0){e.postsCountEl&&(e.postsCountEl.innerText="No posts found with these filters."),e.submitBtn&&v(e.submitBtn);return}e.postsCountEl&&(e.postsCountEl.innerText=`Number of posts to process: ${a}`),await ae(e,a)})}let B=null;function se(e,t,n){e.updatesContent&&(e.updatesContent.innerText="",t&&n?g(e.stepBar4,"failed"):g(e.stepBar4,"done")),e.submitBtn&&(e.submitBtn.disabled=!1),I(e.restartBtn)}function ie(e){var t;(t=e.generateForm)==null||t.addEventListener("submit",async n=>{if(n.preventDefault(),B&&(B(),B=null),!window.nuclenAdminVars||!window.nuclenAdminVars.ajax_url){y("Error: WP Ajax config not found. Please check the plugin settings.");return}g(e.stepBar2,"done"),g(e.stepBar3,"current"),I(e.updatesSection),e.updatesContent&&(e.updatesContent.innerHTML='<span class="spinner is-active"></span><b>Processing posts... this can take a few minutes.</b> Stay on this page to see progress updates in real time. Or else, you can safely leave this page - generation will continue in the background. You can track progress on the tasks page. The generated content will be available in the post editor and on the frontend when the process is complete.'),v(e.step2),e.submitBtn&&(e.submitBtn.disabled=!0);try{const o=Object.fromEntries(new FormData(e.generateForm).entries()),a=await G(o);let r="";a&&a.data&&a.data.generation_id?r=String(a.data.generation_id):a&&a.generation_id&&(r=String(a.generation_id)),r||(d("Generation ID not found in response, using fallback"),r="gen_"+Math.random().toString(36).substring(2)),B=M({intervalMs:5e3,generationId:r,onProgress:(s,c)=>{const i=s===void 0?0:s,l=c===void 0?0:c;if(e.updatesContent){const f=l>0?Math.round(i/l*100):0;e.updatesContent.innerHTML=`<span class="spinner is-active"></span> Processing: ${i} of ${l} posts completed (${f}%)`}},onComplete:async({failCount:s,finalReport:c})=>{B=null,g(e.stepBar3,"done"),g(e.stepBar4,"current"),se(e,s,c)},onError:s=>{var c;if(B=null,s.startsWith("polling-timeout:")||s.startsWith("polling-error:")){const i=s.split(":")[1];window.location.href=`${((c=window.nuclenAdminVars)==null?void 0:c.admin_url)||"/wp-admin/"}admin.php?page=nuclear-engagement-tasks&highlight=${i}`}else g(e.stepBar3,"failed"),x(s),e.updatesContent&&(e.updatesContent.innerText=`Error: ${s}`),e.submitBtn&&(e.submitBtn.disabled=!1),I(e.restartBtn)}})}catch(o){g(e.stepBar3,"failed");const a=o instanceof Error?o.message:"Unknown error";x(a),e.submitBtn&&(e.submitBtn.disabled=!1),I(e.restartBtn)}}),window.addEventListener("beforeunload",()=>{B&&(B(),B=null)})}function ce(e){var t;(t=e.goBackBtn)==null||t.addEventListener("click",()=>{v(e.step2),I(e.step1),e.postsCountEl&&(e.postsCountEl.innerText=""),e.creditsInfoEl&&(e.creditsInfoEl.textContent=""),g(e.stepBar1,"current"),g(e.stepBar2,"todo")})}function le(e){var t;(t=e.restartBtn)==null||t.addEventListener("click",()=>{v(e.updatesSection),v(e.restartBtn),v(e.step2),e.postsCountEl&&(e.postsCountEl.innerText=""),e.creditsInfoEl&&(e.creditsInfoEl.textContent=""),I(e.step1),g(e.stepBar1,"current"),g(e.stepBar2,"todo"),g(e.stepBar3,"todo"),g(e.stepBar4,"todo")})}function ue(){N();const e=document.getElementById("nuclen_generate_workflow"),t=document.getElementById("nuclen_summary_format");e==null||e.addEventListener("change",N),t==null||t.addEventListener("change",N)}function de(){const e=K();e.step1&&e.step1.classList.remove("nuclen-hidden"),e.step2&&e.step2.classList.add("nuclen-hidden"),e.updatesSection&&e.updatesSection.classList.add("nuclen-hidden"),e.restartBtn&&e.restartBtn.classList.add("nuclen-hidden"),e.stepBar1&&e.stepBar1.classList.add("ne-step-bar__step--current"),e.stepBar2&&e.stepBar2.classList.add("ne-step-bar__step--todo"),e.stepBar3&&e.stepBar3.classList.add("ne-step-bar__step--todo"),e.stepBar4&&e.stepBar4.classList.add("ne-step-bar__step--todo"),re(e),ie(e),ce(e),le(e),ue()}de();document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelectorAll(".nav-tab"),t=document.querySelectorAll(".nuclen-tab-content");e.forEach(r=>{r.addEventListener("click",s=>{s.preventDefault();const c=r.getAttribute("href");if(!c)return;e.forEach(l=>l.classList.remove("nav-tab-active")),r.classList.add("nav-tab-active"),t.forEach(l=>{l.style.display="none"});const i=document.querySelector(c);i&&(i.style.display="block")})});const n=document.getElementById("nuclen-custom-theme-section"),o=document.querySelectorAll("input[name='nuclen_theme']");function a(){const r=document.querySelector("input[name='nuclen_theme']:checked");if(!r||!n)return;r.value==="custom"?n.classList.remove("nuclen-hidden"):n.classList.add("nuclen-hidden")}o.forEach(r=>{r.addEventListener("change",a)}),a()});(function(e){e(document).ready(()=>{const t=window.nePointerData;if(!t||!t.pointers||t.pointers.length===0)return;let n=0;const o=t.pointers,a=t.ajaxurl,r=t.nonce;async function s(i){const l=new URLSearchParams;l.append("action","nuclen_dismiss_pointer"),l.append("pointer",i),r&&l.append("nonce",r);try{const f=await C(a,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:l.toString()});f.ok||(d("Failed to dismiss pointer:",f.error),y("Failed to dismiss pointer."))}catch(f){d("Error dismissing pointer:",f),y("Network error while dismissing pointer.")}}function c(){if(n>=o.length)return;const i=o[n],l=e(i.target);if(!l.length){n++,c();return}l.pointer({content:`<h3>${i.title}</h3><p>${i.content}</p>`,position:i.position,close:async()=>{await s(i.id),n++,c()}}).pointer("open")}c()})})(jQuery);(function(){if(!document.body.classList.contains("block-editor-page"))return;const e=window.wp;if(!e||!e.blocks||!e.element||!e.i18n)return;const{registerBlockType:t}=e.blocks,{createElement:n}=e.element,{__:o}=e.i18n;t("nuclear-engagement/quiz",{apiVersion:2,title:o("Quiz","nuclear-engagement"),icon:"editor-help",category:"widgets",edit:()=>n("p",null,o("Quiz will render on the front-end.","nuclear-engagement")),save:()=>null}),t("nuclear-engagement/summary",{apiVersion:2,title:o("Summary","nuclear-engagement"),icon:"excerpt-view",category:"widgets",edit:()=>n("p",null,o("Summary will render on the front-end.","nuclear-engagement")),save:()=>null}),t("nuclear-engagement/toc",{apiVersion:2,title:o("TOC","nuclear-engagement"),icon:"list-view",category:"widgets",edit:()=>n("p",null,o("TOC will render on the front-end.","nuclear-engagement")),save:()=>null})})();
//# sourceMappingURL=nuclen-admin.js.map
