import{e as g,w as M,l as h}from"../../logger-DwRZMuf8.js";const y={RETRY_COUNT:3,INITIAL_DELAY_MS:500,POLLING_INTERVAL_MS:1e4,MAX_BACKOFF_MS:3e4,POLLING_INTERVALS:[{duration:6e4,interval:1e4},{duration:24e4,interval:3e4},{duration:1/0,interval:6e4}],MAX_POLLING_ATTEMPTS:240,MAX_POLLING_TIMEOUT_MS:18e5};async function R(e,t,n=y.RETRY_COUNT,o=y.INITIAL_DELAY_MS,a=3e4){let r=0,s=o,c;for(;r<=n;){try{const l=new window.AbortController,i=setTimeout(()=>l.abort(),a),u=await fetch(e,{...t,signal:l.signal});clearTimeout(i);const{status:w,ok:m}=u,p=await u.text().catch(()=>"");let d=null;if(p)try{d=JSON.parse(p)}catch{}return m?{ok:!0,status:w,data:d}:{ok:!1,status:w,data:d,error:p}}catch(l){if(c=l,c.name==="AbortError"&&(c=new Error(`Request timeout after ${a}ms`)),r===n)break;M(`[RETRY] API request | URL: ${e} | Method: ${t.method||"GET"} | Attempts left: ${n-r} | Error: ${c.message}`),await new Promise(i=>setTimeout(i,s)),s=Math.min(s*2,y.MAX_BACKOFF_MS)}r+=1}throw g(`[ERROR] Max retries exhausted | URL: ${e} | Method: ${t.method||"GET"} | Error: ${(c==null?void 0:c.message)||"Unknown error"}`),c}async function Y(e){var a;if(!window.nuclenAjax||!window.nuclenAjax.ajax_url||!window.nuclenAjax.fetch_action){const r=new Error("[ERROR] Missing configuration | Required: nuclenAjax.ajax_url and nuclenAjax.fetch_action");throw g(r.message),r}const t=new FormData;t.append("action",window.nuclenAjax.fetch_action),window.nuclenAjax.nonce&&t.append("security",window.nuclenAjax.nonce),e&&t.append("generation_id",e);const n=await R(window.nuclenAjax.ajax_url,{method:"POST",body:t,credentials:"same-origin"},y.RETRY_COUNT,y.INITIAL_DELAY_MS,3e4);if(!n.ok){const r=n.error||"Unknown error";if(r.includes("Polling failed after")&&r.includes("attempts"))return{success:!1,message:r,data:{processed:0,total:0,workflow:"unknown"}};const s=new Error(`[ERROR] Fetch updates failed | Status: ${n.status} | Error: ${r}`);throw g(s.message),s}const o=n.data;return h(`[DEBUG] nuclenFetchUpdates response | GenID: ${e} | Success: ${o.success} | Has data: ${!!o.data} | Has results: ${(a=o.data)!=null&&a.results?Object.keys(o.data.results).length:0}`),o}async function V(e){var r;if(!window.nuclenAjax||!window.nuclenAjax.ajax_url){const s=new Error("[ERROR] Missing configuration | Required: nuclenAjax.ajax_url");throw g(s.message),s}const t=new FormData;if(t.append("action","nuclen_trigger_generation"),t.append("payload",JSON.stringify(e)),!((r=window.nuclenAjax)!=null&&r.nonce)){const s=new Error("[ERROR] Security check failed | Missing nonce");throw g(s.message),s}t.append("security",window.nuclenAjax.nonce);const n=await R(window.nuclenAjax.ajax_url,{method:"POST",body:t,credentials:"same-origin"},y.RETRY_COUNT,y.INITIAL_DELAY_MS,6e4);if(!n.ok){const s=new Error(`[ERROR] Generation start failed | Status: ${n.status} | Error: ${n.error||"Unknown error"}`);throw g(s.message),s}const o=n.data;if(!o||typeof o!="object"){const s=new Error("[ERROR] Invalid response | Expected object, received: "+typeof o);throw g(s.message),s}let a;if("success"in o&&typeof o.success=="boolean"?a=o:a={success:!0,data:o},!a.success){let s="Unknown error";a.message?s=a.message:a.data&&typeof a.data=="object"&&a.data.message&&(s=a.data.message);const c=new Error(`[ERROR] Generation start failed | Error: ${s}`);throw g(c.message),c}return a}function H({intervalMs:e=y.POLLING_INTERVAL_MS,generationId:t,onProgress:n=()=>{},onComplete:o=()=>{},onError:a=()=>{},maxAttempts:r=y.MAX_POLLING_ATTEMPTS,timeoutMs:s=y.MAX_POLLING_TIMEOUT_MS,useExponentialBackoff:c=!1,maxIntervalMs:l=6e4,useProgressiveIntervals:i=!0}){if(!t||t.trim()==="")return g("[ERROR] Polling failed | Missing generation ID"),a("No generation ID provided for polling"),()=>{};let u=0;const w=Date.now();let m=e,p=0,d=null,b=null;b=null;const B=A=>{if(!i)return e;let _=0;for(const E of y.POLLING_INTERVALS){if(A<_+E.duration)return E.interval;_+=E.duration}return y.POLLING_INTERVALS[y.POLLING_INTERVALS.length-1].interval},S=()=>{d&&clearTimeout(d);const A=Date.now()-w;i?m=B(A):c&&p>0&&(m=Math.min(e*Math.pow(1.5,p),l)),d=setTimeout(k,m)},k=async()=>{u++;const A=Date.now()-w;if(u>r){d&&clearTimeout(d),a(`polling-timeout:${t}`);return}if(A>s){d&&clearTimeout(d),a(`polling-timeout:${t}`);return}try{const _=await Y(t);if(!_.success){const T=_.message||"Failed to fetch updates. The task may have been cancelled, or there has been an error. Please see the log file on the setup page or contact support.";if(T.includes("Task has been cancelled")||T.includes("cancelled")){d&&clearTimeout(d),h(`[INFO] Task cancelled | GenID: ${t}`),a(`task-cancelled:${t}`);return}if(T.includes("Polling failed after")&&T.includes("attempts")){d&&clearTimeout(d),a(`polling-timeout:${t}`);return}throw g(`[ERROR] Poll failed | GenID: ${t} | Error: ${T}`),new Error(T)}p=0,m=e;const{processed:E,total:x,successCount:N=E,failCount:O,finalReport:W,results:L,workflow:j}=_.data;h(`[DEBUG] Poll progress | GenID: ${t} | Progress: ${E}/${x} | Success: ${N} | Failed: ${O||0}`),h(`[DEBUG] Poll data | GenID: ${t} | Has results: ${!!L} | Results count: ${L?Object.keys(L).length:0} | Workflow: ${j||"undefined"}`),n(E,x,_.data),E>=x?(d&&clearTimeout(d),h(`[SUCCESS] Polling complete | GenID: ${t} | Total: ${x} | Success: ${N} | Failed: ${O||0}`),h(`[DEBUG] Passing to onComplete | GenID: ${t} | Results: ${JSON.stringify(L)} | Workflow: ${j}`),o({processed:E,total:x,successCount:N,failCount:O,finalReport:W,results:L,workflow:j})):S()}catch(_){if(p++,p>=3){d&&clearTimeout(d);const E=_ instanceof Error?_.message:"Unknown error";g(`[ERROR] Polling failed | GenID: ${t} | Attempts: ${u} | Consecutive errors: ${p} | Error: ${E}`),a(`polling-error:${t}`)}else _ instanceof Error&&_.message,S()}};return b||k(),()=>{d&&clearTimeout(d)}}function f(e,t){g(`[ERROR] UI Error | ${e}`);const n=document.createElement("div");n.className="nuclen-error-toast",n.innerHTML=e,document.body.appendChild(n),setTimeout(()=>{n.parentNode&&n.remove()},5e3)}var U;const z=((U=window.nuclenAdminVars)==null?void 0:U.rest_receive_content)||"/wp-json/nuclear-engagement/v1/receive-content";var q;const J=((q=window.nuclenAdminVars)==null?void 0:q.rest_nonce)||"";function $(e){var n;const t=e.replace(/<[^>]+>/g,"");if(t.includes("task-cancelled:")||t.includes("Task has been cancelled")){f("Task has been cancelled. Redirecting to tasks page..."),setTimeout(()=>{var a;const o=`${((a=window.nuclenAdminVars)==null?void 0:a.admin_url)||"/wp-admin/"}admin.php?page=nuclear-engagement-tasks`;window.location.href=o},2e3);return}if(t.includes("Polling failed after")||t.includes("Polling error")||t.includes("Failed to fetch updates")||t.includes("polling-timeout:")||t.includes("polling-error:")){const o=`${((n=window.nuclenAdminVars)==null?void 0:n.admin_url)||"/wp-admin/"}admin.php?page=nuclear-engagement-tasks`;window.location.href=o;return}t.includes("Invalid API key")?f("Your API key is invalid. Please go to the Setup page and enter a new one."):t.includes("Invalid WP App Password")?f("Your WP App Password is invalid. Please re-generate it on the Setup page."):t.includes("Not enough credits")?f("Not enough credits. Please top up your account or reduce the number of posts."):f(`Error: ${t}`)}async function X(e,t,n){const o={workflow:e,results:t};n&&(o.generation_id=n);let a;try{a=await fetch(z,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":J},credentials:"include",body:JSON.stringify(o)})}catch(s){return g("Fetch failed in nuclenStoreGenerationResults:",s),f("Network error"),{ok:!1,data:{message:"Network error"}}}let r=null;if(a.ok)try{r=await a.json()}catch{return{ok:!1,data:{message:"Invalid JSON"}}}return{ok:a.ok,data:r}}function Q(e,t){const{date:n,questions:o}=e,a=t||n,r=document.querySelector('input[name="nuclen_quiz_data[date]"]');r&&(r.readOnly=!1,r.value=a||"",r.readOnly=!0),Array.isArray(o)&&o.forEach((s,c)=>{const l=`input[name="nuclen_quiz_data[questions][${c}][question]"]`,i=document.querySelector(l);i&&(i.value=s.question||""),Array.isArray(s.answers)&&s.answers.forEach((m,p)=>{const d=`input[name="nuclen_quiz_data[questions][${c}][answers][${p}]"]`,b=document.querySelector(d);b&&(b.value=m)});const u=`textarea[name="nuclen_quiz_data[questions][${c}][explanation]"]`,w=document.querySelector(u);w&&(w.value=s.explanation||"")})}function K(e,t){const{date:n,summary:o}=e,a=t||n,r=document.querySelector('input[name="nuclen_summary_data[date]"]');r&&(r.readOnly=!1,r.value=a||"",r.readOnly=!0);const s=document.querySelector('textarea[name="nuclen_summary_data[summary]"]');s&&(s.value=o||"")}const v=new Map;function Z(){document.addEventListener("click",async e=>{var l;const t=e.target;if(!(t instanceof HTMLElement)||!t.classList.contains("nuclen-generate-single"))return;const n=t,o=n.dataset.postId,a=n.dataset.workflow;if(!o||!a){f("Missing data attributes: postId or workflow not found.");return}const r=`${o}-${a}`,s=v.get(r);s&&(s(),v.delete(r)),n.disabled=!0,n.textContent="Generating...";const c={nuclen_selected_post_ids:JSON.stringify([o]),nuclen_selected_generate_workflow:a,source:"single"};if(a==="summary"){const i=document.getElementById("nuclen_summary_dataformat"),u=document.getElementById("nuclen_summary_datalength"),w=document.getElementById("nuclen_summary_datanumber_of_items");i&&(c.nuclen_selected_summary_format=i.value),u&&(i==null?void 0:i.value)==="paragraph"&&(c.nuclen_selected_summary_length=u.value),w&&(i==null?void 0:i.value)==="bullet_list"&&(c.nuclen_selected_summary_number_of_items=w.value)}try{const i=await V(c);if("ok"in i&&!i.ok){$(i.error||"Generation failed"),n.textContent="Generate",n.disabled=!1;return}const u=((l=i.data)==null?void 0:l.generation_id)||i.generation_id||"gen_"+Math.random().toString(36).substring(2),w=H({intervalMs:5e3,generationId:u,onProgress(){n.textContent="Generating..."},async onComplete({results:m,workflow:p}){if(v.delete(r),h(`[DEBUG] onComplete called | PostID: ${o} | Workflow: ${p} | Has results: ${!!m} | Results type: ${typeof m}`),m&&h(`[DEBUG] Results content: ${JSON.stringify(m)}`),m&&typeof m=="object")try{const{ok:d,data:b}=await X(p,m,u),B=b;if(d&&!("code"in B)){const S=m[o];h(`[DEBUG] Post result for ${o}: ${JSON.stringify(S)}`);const k=B.finalDate&&typeof B.finalDate=="string"?B.finalDate:void 0;S?(p==="quiz"?Q(S,k):p==="summary"&&K(S,k),n.textContent="Stored!"):(M(`[WARNING] No result found for post ${o} in results object`),n.textContent="Done (no data for this post)!")}else g("Error storing single-generation results in WP:",B),n.textContent="Generation failed!"}catch(d){g("Fetch error calling /receive-content endpoint:",d),n.textContent="Generation failed!"}else M(`[WARNING] No results received | PostID: ${o} | Results: ${m}`),n.textContent="Done (no data)!";n.disabled=!1},onError(m){var p;v.delete(r),m.startsWith("polling-timeout:")||m.startsWith("polling-error:")?window.location.href=`${((p=window.nuclenAdminVars)==null?void 0:p.admin_url)||"/wp-admin/"}admin.php?page=nuclear-engagement-tasks`:($(m),n.textContent="Generate",n.disabled=!1)}});v.set(r,w)}catch(i){const u=i instanceof Error?i.message:"Unknown error";$(u),n.textContent="Generate",n.disabled=!1}}),window.addEventListener("beforeunload",()=>{v.forEach(e=>e()),v.clear()})}function ee(){const e=document.getElementById("nuclen_summary_dataformat");if(!e)return;const t=document.querySelector(".nuclen-summary-paragraph-options"),n=document.querySelector(".nuclen-summary-bullet-options");function o(){!t||!n||(e.value==="paragraph"?(t.style.display="block",n.style.display="none"):(t.style.display="none",n.style.display="block"))}o(),e.addEventListener("change",o)}function D(){ee(),Z()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",D):setTimeout(D,0);function te(){return{step1:document.getElementById("nuclen-step-1"),step2:document.getElementById("nuclen-step-2"),updatesSection:document.getElementById("nuclen-updates-section"),updatesContent:document.getElementById("nuclen-updates-content"),restartBtn:document.getElementById("nuclen-restart-btn"),getPostsBtn:document.getElementById("nuclen-get-posts-btn"),goBackBtn:document.getElementById("nuclen-go-back-btn"),generateForm:document.getElementById("nuclen-generate-form"),submitBtn:document.getElementById("nuclen-submit-btn"),postsCountEl:document.getElementById("nuclen-posts-count"),stepBar1:document.getElementById("nuclen-step-bar-1"),stepBar2:document.getElementById("nuclen-step-bar-2"),creditsInfoEl:document.getElementById("nuclen-credits-info")}}function C(e){if(e&&(e.classList.remove("nuclen-hidden"),e.id==="nuclen-step-2")){const t=document.getElementById("nuclen-progress-bar");if(t){const n=t.getBoundingClientRect(),o=window.pageYOffset||document.documentElement.scrollTop,a=n.top+o-32;window.scrollTo({top:a,behavior:"smooth"})}else window.scrollTo({top:0,behavior:"smooth"})}}function I(e){e&&e.classList.add("nuclen-hidden")}function P(e,t){e&&(e.classList.remove("ne-step-bar__step--todo","ne-step-bar__step--current","ne-step-bar__step--done","ne-step-bar__step--failed"),e.classList.add(`ne-step-bar__step--${t}`))}async function ne(){var o;if(!window.nuclenAjax||!window.nuclenAjax.ajax_url)throw new Error("Missing nuclenAjax configuration (ajax_url).");if(!window.nuclenAjax.fetch_action)throw new Error("Missing fetch_action in nuclenAjax configuration.");const e=new FormData;e.append("action",window.nuclenAjax.fetch_action),window.nuclenAjax.nonce&&e.append("security",window.nuclenAjax.nonce);const t=await R(window.nuclenAjax.ajax_url,{method:"POST",body:e,credentials:"same-origin"});if(!t.ok)throw new Error(t.error||`HTTP ${t.status}`);const n=t.data;if(!n.success)throw new Error(n.message||((o=n.data)==null?void 0:o.message)||"Failed to fetch credits from SaaS");if(typeof n.data.remaining_credits=="number")return n.data.remaining_credits;throw new Error("No 'remaining_credits' in response")}function G(){const e=document.getElementById("nuclen_generate_workflow"),t=document.getElementById("nuclen-summary-format-row"),n=document.getElementById("nuclen-summary-paragraph-row"),o=document.getElementById("nuclen-summary-bullet-row"),a=document.getElementById("nuclen_format");!e||!t||(e.value==="summary"?(t.classList.remove("nuclen-hidden"),a&&n&&o&&(a.value==="paragraph"?(n.classList.remove("nuclen-hidden"),o.classList.add("nuclen-hidden")):(n.classList.add("nuclen-hidden"),o.classList.remove("nuclen-hidden")))):(t.classList.add("nuclen-hidden"),n&&n.classList.add("nuclen-hidden"),o&&o.classList.add("nuclen-hidden")))}function oe(){const e=document.getElementById("nuclen_post_status"),t=document.getElementById("nuclen_category"),n=document.getElementById("nuclen_author"),o=document.getElementById("nuclen_post_type"),a=document.getElementById("nuclen_generate_workflow"),r=document.getElementById("nuclen_allow_regenerate_data"),s=document.getElementById("nuclen_regenerate_protected_data"),c=document.getElementById("nuclen_format"),l=document.getElementById("nuclen_length"),i=document.getElementById("nuclen_number_of_items");return{postStatus:e?e.value:"",category:t?t.value:"",author:n?n.value:"",postType:o?o.value:"",workflow:a?a.value:"",allowRegenerate:!!r&&r.checked,regenerateProtected:!!s&&s.checked,summaryFormat:c?c.value:"",summaryLength:l?l.value:"",summaryNumberOfItems:i?i.value:""}}function ae(e,t){e.append("nuclen_post_status",t.postStatus),e.append("nuclen_category",t.category),e.append("nuclen_author",t.author),e.append("nuclen_post_type",t.postType),e.append("nuclen_generate_workflow",t.workflow),e.append("nuclen_allow_regenerate_data",t.allowRegenerate?"1":"0"),e.append("nuclen_regenerate_protected_data",t.regenerateProtected?"1":"0"),e.append("nuclen_summary_format",t.summaryFormat),e.append("nuclen_summary_length",t.summaryLength),e.append("nuclen_summary_number_of_items",t.summaryNumberOfItems)}function se(e){const t=document.getElementById("nuclen_selected_generate_workflow"),n=document.getElementById("nuclen_selected_summary_format"),o=document.getElementById("nuclen_selected_summary_length"),a=document.getElementById("nuclen_selected_summary_number_of_items"),r=document.getElementById("nuclen_selected_post_status"),s=document.getElementById("nuclen_selected_post_type");t&&(t.value=e.workflow),n&&(n.value=e.summaryFormat),o&&(o.value=e.summaryLength),a&&(a.value=e.summaryNumberOfItems),r&&(r.value=e.postStatus),s&&(s.value=e.postType)}async function re(e,t){var a;const n=new FormData;n.append("action","nuclen_get_posts_count"),(a=window.nuclenAjax)!=null&&a.nonce&&n.append("security",window.nuclenAjax.nonce),ae(n,t);const o=await R(e,{method:"POST",body:n,credentials:"same-origin"});return o.ok?o.data:null}async function ie(e,t){try{const n=await ne(),o=t;e.creditsInfoEl&&(e.creditsInfoEl.textContent=`This will consume ${o} credit(s). You have ${n} left.`),n<o?(f("Not enough credits. Please top up or reduce the number of posts."),e.submitBtn&&(e.submitBtn.disabled=!0)):e.submitBtn&&(C(e.submitBtn),e.submitBtn.disabled=!1)}catch(n){g("Error fetching remaining credits:",n);const o=n instanceof Error?n.message:"Unknown error";e.creditsInfoEl&&(e.creditsInfoEl.textContent=`Unable to retrieve your credits: ${o}`),e.submitBtn&&I(e.submitBtn)}}function ce(e){var t;(t=e.getPostsBtn)==null||t.addEventListener("click",async()=>{var l,i;if(!window.nuclenAjax||!window.nuclenAjax.ajax_url){f("Error: Ajax is not configured properly. Please check the plugin settings.");return}const n=((l=e.getPostsBtn)==null?void 0:l.textContent)||"Get Posts to Process";e.getPostsBtn&&(e.getPostsBtn.textContent="Selecting posts...",e.getPostsBtn.disabled=!0),e.postsCountEl&&(e.postsCountEl.innerText="Loading posts...");const o=oe(),a=await re(window.nuclenAjax.ajax_url||"",o);if(!a){g("Error retrieving post count"),e.postsCountEl&&(e.postsCountEl.innerText="Error retrieving post count."),e.getPostsBtn&&(e.getPostsBtn.textContent=n,e.getPostsBtn.disabled=!1);return}if(!a.success){e.postsCountEl&&(e.postsCountEl.innerText="Error retrieving post count.");const u=a.message||((i=a.data)==null?void 0:i.message);u&&(u.includes("Invalid API key")?f("Your Gold Code (API key) is invalid. Please create a new one on the NE app and enter it on the plugin Setup page."):u.includes("Invalid WP App Password")?f("Your WP App Password is invalid. Please go to the plugin Setup page and re-generate it."):f(u)),e.getPostsBtn&&(e.getPostsBtn.textContent=n,e.getPostsBtn.disabled=!1);return}const r=a.data.count,s=a.data.post_ids,c=document.getElementById("nuclen_selected_post_ids");if(c&&(c.value=JSON.stringify(s)),se(o),I(e.step1),C(e.step2),P(e.stepBar1,"done"),P(e.stepBar2,"current"),r===0){e.postsCountEl&&(e.postsCountEl.innerText="No posts found with these filters."),e.submitBtn&&I(e.submitBtn);return}e.postsCountEl&&(e.postsCountEl.innerText=`Number of posts to process: ${r}`),await ie(e,r)})}function le(e,t){const n=document.createElement("div");n.className="nuclen-success-toast",n.innerHTML=e,document.body.appendChild(n),setTimeout(()=>{n.parentNode&&n.remove()},5e3)}function F(e,t="success"){h(`[PAGE MESSAGE] ${t.toUpperCase()} | ${e}`);let n=document.getElementById("nuclen-page-message");if(!n){const o=document.querySelector(".nuclen-heading");o&&(n=document.createElement("div"),n.id="nuclen-page-message",o.insertAdjacentElement("afterend",n))}if(n){n.innerHTML="";const o=document.createElement("div");o.className=`nuclen-page-message nuclen-page-message--${t}`,o.innerHTML=`
			<div class="nuclen-page-message__icon">
				${t==="success"?"✓":t==="warning"?"⚠":"ℹ"}
			</div>
			<div class="nuclen-page-message__text">${e}</div>
		`,n.appendChild(o),t!=="warning"&&setTimeout(()=>{o.style.opacity="0",setTimeout(()=>o.remove(),300)},1e4)}}function ue(e){var t;(t=e.generateForm)==null||t.addEventListener("submit",async n=>{if(n.preventDefault(),!window.nuclenAdminVars||!window.nuclenAdminVars.ajax_url){f("Error: WP Ajax config not found. Please check the plugin settings.");return}P(e.stepBar2,"done"),I(e.step2),e.submitBtn&&(e.submitBtn.disabled=!0,e.submitBtn.innerHTML='<span class="spinner is-active" style="float: none; margin: 0 8px 0 0;"></span>Starting generation...'),F("Starting content generation...","info");try{const o=Object.fromEntries(new FormData(e.generateForm).entries()),a=await V(o);let r="";a&&a.data&&a.data.generation_id?r=String(a.data.generation_id):a&&a.generation_id&&(r=String(a.generation_id)),r||(g("Generation ID not found in response, using fallback"),r="gen_"+Math.random().toString(36).substring(2)),F("✅ Generation task started successfully! Content is being generated in the background.","success"),le("Redirecting to tasks page in a moment..."),setTimeout(()=>{var c;const s=`${((c=window.nuclenAdminVars)==null?void 0:c.admin_url)||"/wp-admin/"}admin.php?page=nuclear-engagement-tasks`;window.location.href=s},3e3)}catch(o){const a=o instanceof Error?o.message:"Unknown error";$(a),e.submitBtn&&(e.submitBtn.disabled=!1)}})}function de(e){var t;(t=e.goBackBtn)==null||t.addEventListener("click",()=>{I(e.step2),C(e.step1),e.postsCountEl&&(e.postsCountEl.innerText=""),e.creditsInfoEl&&(e.creditsInfoEl.textContent=""),e.getPostsBtn&&(e.getPostsBtn.textContent="Get Posts to Process",e.getPostsBtn.disabled=!1),P(e.stepBar1,"current"),P(e.stepBar2,"todo")})}function me(e){var t;(t=e.restartBtn)==null||t.addEventListener("click",()=>{I(e.updatesSection),I(e.restartBtn),I(e.step2),e.postsCountEl&&(e.postsCountEl.innerText=""),e.creditsInfoEl&&(e.creditsInfoEl.textContent=""),e.getPostsBtn&&(e.getPostsBtn.textContent="Get Posts to Process",e.getPostsBtn.disabled=!1),C(e.step1),P(e.stepBar1,"current"),P(e.stepBar2,"todo")})}function pe(){G();const e=document.getElementById("nuclen_generate_workflow"),t=document.getElementById("nuclen_format");e==null||e.addEventListener("change",G),t==null||t.addEventListener("change",G)}function ge(){const e=te();e.step1&&e.step1.classList.remove("nuclen-hidden"),e.step2&&e.step2.classList.add("nuclen-hidden"),e.updatesSection&&e.updatesSection.classList.add("nuclen-hidden"),e.restartBtn&&e.restartBtn.classList.add("nuclen-hidden"),e.stepBar1&&e.stepBar1.classList.add("ne-step-bar__step--current"),e.stepBar2&&e.stepBar2.classList.add("ne-step-bar__step--todo"),ce(e),ue(e),de(e),me(e),pe()}ge();document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelectorAll(".nav-tab"),t=document.querySelectorAll(".nuclen-tab-content");e.forEach(s=>{s.addEventListener("click",c=>{c.preventDefault();const l=s.getAttribute("href");if(!l)return;e.forEach(u=>u.classList.remove("nav-tab-active")),s.classList.add("nav-tab-active"),t.forEach(u=>{u.style.display="none"});const i=document.querySelector(l);i&&(i.style.display="block")})});const n=document.getElementById("nuclen-custom-theme-section"),o=document.querySelectorAll("input[name='nuclen_theme']");function a(){const s=document.querySelector("input[name='nuclen_theme']:checked");if(!s||!n)return;s.value==="custom"?n.classList.remove("nuclen-hidden"):n.classList.add("nuclen-hidden")}o.forEach(s=>{s.addEventListener("change",a)}),a();function r(){const s=document.getElementById("auto_summary_format");if(!s)return;const c=document.querySelector(".nuclen-summary-paragraph-options"),l=document.querySelector(".nuclen-summary-bullet-options");function i(){!c||!l||(s.value==="paragraph"?(c.style.display="block",l.style.display="none"):(c.style.display="none",l.style.display="block"))}i(),s.addEventListener("change",i)}r()});(function(e){e(document).ready(()=>{const t=window.nePointerData;if(!t||!t.pointers||t.pointers.length===0)return;let n=0;const o=t.pointers,a=t.ajaxurl,r=t.nonce;async function s(l){const i=new URLSearchParams;i.append("action","nuclen_dismiss_pointer"),i.append("pointer",l),r&&i.append("nonce",r);try{const u=await R(a,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i.toString()});u.ok||(g("Failed to dismiss pointer:",u.error),f("Failed to dismiss pointer."))}catch(u){g("Error dismissing pointer:",u),f("Network error while dismissing pointer.")}}function c(){if(n>=o.length)return;const l=o[n],i=e(l.target);if(!i.length){n++,c();return}i.pointer({content:`<h3>${l.title}</h3><p>${l.content}</p>`,position:l.position,close:async()=>{await s(l.id),n++,c()}}).pointer("open")}c()})})(jQuery);(function(){if(!document.body.classList.contains("block-editor-page"))return;const e=window.wp;if(!e||!e.blocks||!e.element||!e.i18n)return;const{registerBlockType:t}=e.blocks,{createElement:n}=e.element,{__:o}=e.i18n;t("nuclear-engagement/quiz",{apiVersion:2,title:o("Quiz","nuclear-engagement"),icon:"editor-help",category:"widgets",edit:()=>n("p",null,o("Quiz will render on the front-end.","nuclear-engagement")),save:()=>null}),t("nuclear-engagement/summary",{apiVersion:2,title:o("Summary","nuclear-engagement"),icon:"excerpt-view",category:"widgets",edit:()=>n("p",null,o("Summary will render on the front-end.","nuclear-engagement")),save:()=>null}),t("nuclear-engagement/toc",{apiVersion:2,title:o("TOC","nuclear-engagement"),icon:"list-view",category:"widgets",edit:()=>n("p",null,o("TOC will render on the front-end.","nuclear-engagement")),save:()=>null})})();
//# sourceMappingURL=nuclen-admin.js.map
