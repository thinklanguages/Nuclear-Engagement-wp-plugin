function k(){const i=document.querySelectorAll(".nuclen-toc-sticky");i.length&&i.forEach(t=>{const e=t.querySelector(".nuclen-toc");if(!e)return;const o=parseInt(t.dataset.offsetY||"20",10),a=parseInt(t.dataset.offsetX||"20",10);t.dataset.showContent==="false"&&(e.style.display="none");let n=t.getBoundingClientRect(),r=n.top+window.pageYOffset,f=n.left,h=n.width,y=!1,u=null;const m=parseInt(t.dataset.maxWidth||"0",10),s=document.createElement("div");s.className="nuclen-toc-placeholder",s.style.height=`${n.height}px`,s.style.width=`${n.width}px`,t.insertAdjacentElement("afterend",s),s.style.display="none",t.style.transition="top 0.25s ease-out";const x=c=>{const d=document.querySelector(".entry-content, .post, .content-area, .site-main, main"),g=d?d.getBoundingClientRect().left:f,$=a,b=window.innerWidth-c-a;return Math.max($,Math.min(g,b))},v=()=>window.innerHeight-o*2;e.style.position="relative",e.style.width="100%";const E=c=>{if(c!==y)if(y=c,y){const d=v(),g=m>0?Math.min(h,m):h;t.classList.add("nuclen-toc-stuck"),t.style.position="fixed",t.style.top=`${o}px`,t.style.left=`${x(g)}px`,t.style.width=`${g}px`,t.style.maxHeight=`${d}px`,t.style.overflow="visible",e.style.maxHeight=`${d}px`,e.style.overflow="auto",s.style.display="block",s.style.width=`${g}px`,s.style.height=`${n.height}px`}else t.classList.remove("nuclen-toc-stuck"),t.style.cssText="transition: top 0.25s ease-out;",e.style.maxHeight="",e.style.overflow="",s.style.display="none"},w=()=>{u||(u=window.requestAnimationFrame(()=>{u=null;const c=window.pageYOffset+o>=r;E(c)}))},L=()=>{u&&window.cancelAnimationFrame(u),u=window.requestAnimationFrame(()=>{u=null,n=t.getBoundingClientRect(),f=n.left,h=n.width;const c=m>0?Math.min(h,m):h;if(s.style.width=`${c}px`,s.style.height=`${n.height}px`,y){const d=v();t.style.left=`${x(c)}px`,t.style.width=`${c}px`,t.style.maxHeight=`${d}px`,e.style.maxHeight=`${d}px`}})};window.addEventListener("scroll",w,{passive:!0}),window.addEventListener("resize",L),w()})}function A(){document.addEventListener("click",i=>{const t=i.target.closest(".nuclen-toc-toggle");if(!t)return;const e=t.getAttribute("aria-controls"),o=e?document.getElementById(e):null,a=t.getAttribute("aria-expanded")==="true";t.setAttribute("aria-expanded",a?"false":"true"),o&&(o.style.display=a?"none":"");const l=window.nuclenTocL10n;t.textContent=a?l.show:l.hide})}function p(){document.addEventListener("click",i=>{const t=i.target.closest(".nuclen-toc a"),e=t?t.closest(".nuclen-toc-sticky"):null;!t||!e||setTimeout(()=>{const o=e.querySelector('.nuclen-toc-toggle[aria-expanded="true"]');o&&o.click()},120)}),document.addEventListener("click",i=>{const t=document.querySelector(".nuclen-toc-sticky.nuclen-toc-stuck");if(!t)return;const e=i.target;if(!t.contains(e)&&!e.closest(".nuclen-toc-toggle")){const o=t.querySelector('.nuclen-toc-toggle[aria-expanded="true"]');o&&o.click()}})}function q(){const i=document.querySelectorAll('.nuclen-toc[data-highlight="true"]');if(!i.length||!("IntersectionObserver"in window))return;const t={rootMargin:"0px 0px -60%",threshold:0};i.forEach(e=>{const o=new Map;if(e.querySelectorAll('a[href^="#"]').forEach(l=>{const n=l.getAttribute("href").slice(1),r=n&&document.getElementById(n);r&&o.set(r,l)}),!o.size)return;const a=new IntersectionObserver(l=>{l.forEach(n=>{const r=o.get(n.target);r&&n.isIntersecting&&(e.querySelectorAll("a.is-active").forEach(f=>{f.classList.remove("is-active"),f.removeAttribute("aria-current")}),r.classList.add("is-active"),r.setAttribute("aria-current","location"))})},t);o.forEach((l,n)=>a.observe(n))})}function S(){A(),p(),q()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{k(),S()}):(k(),S());
