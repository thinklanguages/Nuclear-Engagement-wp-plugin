function k(n,t,e,i,c,s,o,l){n.classList.add("nuclen-toc-stuck"),n.style.position="fixed",n.style.top=`${o}px`,n.style.left=`${i}px`,n.style.width=`${c}px`,n.style.maxHeight=`${s}px`,n.style.overflow="visible",t.style.maxHeight=`${s}px`,t.style.overflow="auto",e.style.display="block",e.style.width=`${c}px`,e.style.height=`${l}px`}function q(n,t,e){n.classList.remove("nuclen-toc-stuck"),n.style.cssText="transition: top 0.25s ease-out;",t.style.maxHeight="",t.style.overflow="",e.style.display="none"}function S(){const n=document.querySelectorAll(".nuclen-toc-sticky");n.length&&n.forEach(t=>{const e=t.querySelector(".nuclen-toc");if(!e)return;const i=parseInt(t.dataset.offsetY||"20",10),c=parseInt(t.dataset.offsetX||"20",10);t.dataset.showContent==="false"&&(e.style.display="none");let o=t.getBoundingClientRect(),l=o.top+window.pageYOffset,f=o.left,h=o.width,y=!1,d=null;const g=parseInt(t.dataset.maxWidth||"0",10),a=document.createElement("div");a.className="nuclen-toc-placeholder",a.style.height=`${o.height}px`,a.style.width=`${o.width}px`,t.insertAdjacentElement("afterend",a),a.style.display="none",t.style.transition="top 0.25s ease-out";const x=r=>{const u=document.querySelector(".entry-content, .post, .content-area, .site-main, main"),m=u?u.getBoundingClientRect().left:f,A=c,p=window.innerWidth-r-c;return Math.max(A,Math.min(m,p))},v=()=>window.innerHeight-i*2;e.style.position="relative",e.style.width="100%";const L=r=>{if(r!==y)if(y=r,y){const u=v(),m=g>0?Math.min(h,g):h;k(t,e,a,x(m),m,u,i,o.height)}else q(t,e,a)},w=()=>{d||(d=window.requestAnimationFrame(()=>{d=null;const r=window.pageYOffset+i>=l;L(r)}))},b=()=>{d&&window.cancelAnimationFrame(d),d=window.requestAnimationFrame(()=>{d=null,o=t.getBoundingClientRect(),f=o.left,h=o.width;const r=g>0?Math.min(h,g):h;if(a.style.width=`${r}px`,a.style.height=`${o.height}px`,y){const u=v();k(t,e,a,x(r),r,u,i,o.height)}})};window.addEventListener("scroll",w,{passive:!0}),window.addEventListener("resize",b),w()})}function $(){document.addEventListener("click",n=>{const t=n.target.closest(".nuclen-toc-toggle");if(!t)return;const e=t.getAttribute("aria-controls"),i=e?document.getElementById(e):null,c=t.getAttribute("aria-expanded")==="true";t.setAttribute("aria-expanded",c?"false":"true"),i&&(i.style.display=c?"none":"");const s=window.nuclenTocL10n;t.textContent=c?s.show:s.hide})}function C(){document.addEventListener("click",n=>{const t=n.target.closest(".nuclen-toc a"),e=t?t.closest(".nuclen-toc-sticky"):null;!t||!e||setTimeout(()=>{const i=e.querySelector('.nuclen-toc-toggle[aria-expanded="true"]');i&&i.click()},120)}),document.addEventListener("click",n=>{const t=document.querySelector(".nuclen-toc-sticky.nuclen-toc-stuck");if(!t)return;const e=n.target;if(!t.contains(e)&&!e.closest(".nuclen-toc-toggle")){const i=t.querySelector('.nuclen-toc-toggle[aria-expanded="true"]');i&&i.click()}})}function I(){const n=document.querySelectorAll('.nuclen-toc[data-highlight="true"]');if(!n.length||!("IntersectionObserver"in window))return;const t={rootMargin:"0px 0px -60%",threshold:0};n.forEach(e=>{const i=new Map;if(e.querySelectorAll('a[href^="#"]').forEach(s=>{const o=s.getAttribute("href").slice(1),l=o&&document.getElementById(o);l&&i.set(l,s)}),!i.size)return;const c=new IntersectionObserver(s=>{s.forEach(o=>{const l=i.get(o.target);l&&o.isIntersecting&&(e.querySelectorAll("a.is-active").forEach(f=>{f.classList.remove("is-active"),f.removeAttribute("aria-current")}),l.classList.add("is-active"),l.setAttribute("aria-current","location"))})},t);i.forEach((s,o)=>c.observe(o))})}function E(){$(),C(),I()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{S(),E()}):(S(),E());
