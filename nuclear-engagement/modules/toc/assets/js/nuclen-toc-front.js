var q=Object.defineProperty;var _=(n,t,e)=>t in n?q(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var m=(n,t,e)=>_(n,typeof t!="symbol"?t+"":t,e);function E(n,t,e,i,c,s,o,l){n.classList.add("nuclen-toc-stuck"),n.style.position="fixed",n.style.top=`${o}px`,n.style.left=`${i}px`,n.style.width=`${c}px`,n.style.maxHeight=`${s}px`,n.style.overflow="visible",t.style.maxHeight=`${s}px`,t.style.overflow="auto",e.style.display="block",e.style.width=`${c}px`,e.style.height=`${l}px`}function I(n,t,e){n.classList.remove("nuclen-toc-stuck"),n.style.cssText="transition: top 0.25s ease-out;",t.style.maxHeight="",t.style.overflow="",e.style.display="none"}function p(){const n=document.querySelectorAll(".nuclen-toc-sticky");n.length&&n.forEach(t=>{const e=t.querySelector(".nuclen-toc");if(!e)return;const i=parseInt(t.dataset.offsetY||"20",10),c=parseInt(t.dataset.offsetX||"20",10);t.dataset.showContent==="false"&&(e.style.display="none");let o=t.getBoundingClientRect();const l=o.top+window.pageYOffset;let g=o.left,h=o.width,f=!1,u=null;const y=parseInt(t.dataset.maxWidth||"0",10),a=document.createElement("div");a.className="nuclen-toc-placeholder",a.style.height=`${o.height}px`,a.style.width=`${o.width}px`,t.insertAdjacentElement("afterend",a),a.style.display="none",t.style.transition="top 0.25s ease-out";const k=r=>{const d=document.querySelector(".entry-content, .post, .content-area, .site-main, main"),v=d?d.getBoundingClientRect().left:g,C=c,L=window.innerWidth-r-c;return Math.max(C,Math.min(v,L))},x=()=>window.innerHeight-i*2;e.style.position="relative",e.style.width="100%";const b=r=>{if(r!==f)if(f=r,f){const d=x(),v=y>0?Math.min(h,y):h;E(t,e,a,k(v),v,d,i,o.height)}else I(t,e,a)},T=()=>{u||(u=window.requestAnimationFrame(()=>{u=null;const r=window.pageYOffset+i>=l;b(r)}))};let w=null;const A=()=>{w!==null&&clearTimeout(w),w=window.setTimeout(()=>{u&&window.cancelAnimationFrame(u),u=window.requestAnimationFrame(()=>{u=null,o=t.getBoundingClientRect(),g=o.left,h=o.width;const r=y>0?Math.min(h,y):h;if(a.style.width=`${r}px`,a.style.height=`${o.height}px`,f){const d=x();E(t,e,a,k(r),r,d,i,o.height)}})},150)};window.addEventListener("scroll",T,{passive:!0}),window.addEventListener("resize",A),T()})}function O(){document.addEventListener("click",n=>{const t=n.target.closest(".nuclen-toc-toggle");if(!t)return;const e=t.getAttribute("aria-controls"),i=e?document.getElementById(e):null,c=t.getAttribute("aria-expanded")==="true";t.setAttribute("aria-expanded",c?"false":"true"),i&&(i.style.display=c?"none":"");const s=window.nuclenTocL10n;t.textContent=c?s.show:s.hide})}function $(){document.addEventListener("click",n=>{const t=n.target.closest(".nuclen-toc a"),e=t?t.closest(".nuclen-toc-sticky"):null;!t||!e||setTimeout(()=>{const i=e.querySelector('.nuclen-toc-toggle[aria-expanded="true"]');i&&i.click()},120)}),document.addEventListener("click",n=>{const t=document.querySelector(".nuclen-toc-sticky.nuclen-toc-stuck");if(!t)return;const e=n.target;if(!t.contains(e)&&!e.closest(".nuclen-toc-toggle")){const i=t.querySelector('.nuclen-toc-toggle[aria-expanded="true"]');i&&i.click()}})}function B(){const n=document.querySelectorAll('.nuclen-toc[data-highlight="true"]');if(!n.length||!("IntersectionObserver"in window))return;const t={rootMargin:"0px 0px -60%",threshold:0};n.forEach(e=>{const i=new Map;if(e.querySelectorAll('a[href^="#"]').forEach(s=>{const o=s.getAttribute("href").slice(1),l=o&&document.getElementById(o);l&&i.set(l,s)}),!i.size)return;const c=new IntersectionObserver(s=>{s.forEach(o=>{const l=i.get(o.target);l&&o.isIntersecting&&(e.querySelectorAll("a.is-active").forEach(g=>{g.classList.remove("is-active"),g.removeAttribute("aria-current")}),l.classList.add("is-active"),l.setAttribute("aria-current","location"))})},t);i.forEach((s,o)=>c.observe(o))})}class M{constructor(t){m(this,"tocNav");m(this,"toggleButton");m(this,"hasViewEventFired",!1);this.tocNav=t.querySelector(".nuclen-toc"),this.toggleButton=t.querySelector(".nuclen-toc-toggle"),this.tocNav&&this.init()}init(){this.setupViewTracking(),this.setupClickTracking(),this.setupToggleTracking()}setupViewTracking(){new IntersectionObserver(e=>{e.forEach(i=>{i.isIntersecting&&i.intersectionRatio>=.8&&!this.hasViewEventFired&&(this.hasViewEventFired=!0,gtag("event","nuclen_toc_view",{event_category:"TOC",event_label:"TOC fully visible",value:window.location.pathname}))})},{threshold:.8}).observe(this.tocNav)}setupClickTracking(){this.tocNav.querySelectorAll("a").forEach(e=>{e.addEventListener("click",i=>{var l;const c=i.currentTarget,s=((l=c.textContent)==null?void 0:l.trim())||"",o=c.getAttribute("href")||"";gtag("event","nuclen_toc_click",{event_category:"TOC",event_label:s,value:o})})})}setupToggleTracking(){this.toggleButton&&this.toggleButton.addEventListener("click",()=>{const e=this.toggleButton.getAttribute("aria-expanded")==="true"?"hide":"show";gtag("event","nuclen_toc_toggle",{event_category:"TOC",event_label:e})})}}function S(){O(),$(),B(),document.querySelectorAll(".nuclen-toc-wrapper").forEach(t=>{new M(t)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{p(),S()}):(p(),S());
//# sourceMappingURL=nuclen-toc-front.js.map
