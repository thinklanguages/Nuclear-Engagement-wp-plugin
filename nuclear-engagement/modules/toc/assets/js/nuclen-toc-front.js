function k(){const u=document.querySelectorAll(".nuclen-toc-sticky");u.length&&u.forEach(t=>{const o=t.querySelector(".nuclen-toc");if(!o)return;const e=parseInt(t.dataset.offsetY||"20",10),s=parseInt(t.dataset.offsetX||"20",10);t.dataset.showContent==="false"&&(o.style.display="none");let n=t.getBoundingClientRect(),c=n.top+window.pageYOffset,h=n.left,f=n.width,y=!1,d=null;const m=parseInt(t.dataset.maxWidth||"0",10),l=document.createElement("div");l.className="nuclen-toc-placeholder",l.style.height=`${n.height}px`,l.style.width=`${n.width}px`,t.insertAdjacentElement("afterend",l),l.style.display="none",t.style.transition="top 0.25s ease-out";const x=a=>{const r=document.querySelector(".entry-content, .post, .content-area, .site-main, main"),g=r?r.getBoundingClientRect().left:h,$=s,b=window.innerWidth-a-s;return Math.max($,Math.min(g,b))},v=()=>window.innerHeight-e*2;o.style.position="relative",o.style.width="100%";const L=a=>{if(a!==y)if(y=a,y){const r=v(),g=m>0?Math.min(f,m):f;t.classList.add("nuclen-toc-stuck"),t.style.position="fixed",t.style.top=`${e}px`,t.style.left=`${x(g)}px`,t.style.width=`${g}px`,t.style.maxHeight=`${r}px`,t.style.overflow="visible",o.style.maxHeight=`${r}px`,o.style.overflow="auto",l.style.display="block",l.style.width=`${g}px`,l.style.height=`${n.height}px`}else t.classList.remove("nuclen-toc-stuck"),t.style.cssText="transition: top 0.25s ease-out;",o.style.maxHeight="",o.style.overflow="",l.style.display="none"},w=()=>{d||(d=window.requestAnimationFrame(()=>{d=null;const a=window.pageYOffset+e>=c;L(a)}))},S=()=>{d&&window.cancelAnimationFrame(d),d=window.requestAnimationFrame(()=>{d=null,n=t.getBoundingClientRect(),h=n.left,f=n.width;const a=m>0?Math.min(f,m):f;if(l.style.width=`${a}px`,l.style.height=`${n.height}px`,y){const r=v();t.style.left=`${x(a)}px`,t.style.width=`${a}px`,t.style.maxHeight=`${r}px`,o.style.maxHeight=`${r}px`}})};window.addEventListener("scroll",w,{passive:!0}),window.addEventListener("resize",S),w()})}function E(){document.addEventListener("click",o=>{const e=o.target.closest(".nuclen-toc-toggle");if(!e)return;const s=e.getAttribute("aria-controls"),i=s?document.getElementById(s):null,n=e.getAttribute("aria-expanded")==="true";e.setAttribute("aria-expanded",n?"false":"true"),i&&(i.style.display=n?"none":"");const c=window.nuclenTocL10n;e.textContent=n?c.show:c.hide}),document.addEventListener("click",o=>{const e=o.target.closest(".nuclen-toc a"),s=e?e.closest(".nuclen-toc-sticky"):null;!e||!s||setTimeout(()=>{const i=s.querySelector('.nuclen-toc-toggle[aria-expanded="true"]');i&&i.click()},120)}),document.addEventListener("click",o=>{const e=document.querySelector(".nuclen-toc-sticky.nuclen-toc-stuck");if(!e)return;const s=o.target;if(!e.contains(s)&&!s.closest(".nuclen-toc-toggle")){const i=e.querySelector('.nuclen-toc-toggle[aria-expanded="true"]');i&&i.click()}});const u=document.querySelectorAll('.nuclen-toc[data-highlight="true"]');if(!u.length||!("IntersectionObserver"in window))return;const t={rootMargin:"0px 0px -60%",threshold:0};u.forEach(o=>{const e=new Map;if(o.querySelectorAll('a[href^="#"]').forEach(i=>{const n=i.getAttribute("href").slice(1),c=n&&document.getElementById(n);c&&e.set(c,i)}),!e.size)return;const s=new IntersectionObserver(i=>{i.forEach(n=>{const c=e.get(n.target);c&&n.isIntersecting&&(o.querySelectorAll("a.is-active").forEach(h=>{h.classList.remove("is-active"),h.removeAttribute("aria-current")}),c.classList.add("is-active"),c.setAttribute("aria-current","location"))})},t);e.forEach((i,n)=>s.observe(n))})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{k(),E()}):(k(),E());
