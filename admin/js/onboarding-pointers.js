(function(){"use strict";function w(...o){}function h(...o){console.error(...o)}async function g(o,n,l=3,p=500){let s=0,e=p,a;for(;s<=l;){try{const t=await fetch(o,n),{status:i,ok:c}=t,r=await t.text().catch(()=>"");let d=null;if(r)try{d=JSON.parse(r)}catch{d=null}return c?{ok:!0,status:i,data:d}:{ok:!1,status:i,data:d,error:r}}catch(t){if(a=t,s===l)break;w(`Retrying request to ${o} with method ${n.method||"GET"} (${l-s} attempts left). Error: ${a.message}`,a),await new Promise(i=>setTimeout(i,e)),e*=2}s+=1}throw h(`Max retries reached for ${o} with method ${n.method||"GET"}:`,a),a}function u(o){const n=document.createElement("div");n.className="nuclen-error-toast",n.textContent=o,document.body.appendChild(n),setTimeout(()=>n.remove(),5e3),h(o)}function y(){if(typeof window.nePointerData>"u")return;const{pointers:o,ajaxurl:n,nonce:l}=window.nePointerData;if(!Array.isArray(o)||!o.length)return;let p=0;function s(){if(p>=o.length)return;const e=o[p],a=document.querySelector(e.target);if(!a){p++,s();return}const t=document.createElement("div");t.className="wp-pointer pointer-"+e.position.edge,t.style.position="absolute",t.innerHTML='<div class="wp-pointer-content"><h3>'+e.title+"</h3><p>"+e.content+'</p><a class="close" href="#">Dismiss</a></div>',document.body.appendChild(t);const i=a.getBoundingClientRect();let c=window.scrollY+i.top,r=window.scrollX+i.left;switch(e.position.edge){case"top":c-=t.offsetHeight;break;case"bottom":c+=i.height;break;case"left":r-=t.offsetWidth;break;case"right":r+=i.width;break}e.position.align==="center"?e.position.edge==="top"||e.position.edge==="bottom"?r+=(i.width-t.offsetWidth)/2:c+=(i.height-t.offsetHeight)/2:(e.position.align==="right"||e.position.align==="bottom")&&(e.position.edge==="top"||e.position.edge==="bottom"?r+=i.width-t.offsetWidth:c+=i.height-t.offsetHeight),t.style.top=Math.max(c,0)+"px",t.style.left=Math.max(r,0)+"px";const d=t.querySelector(".close");d&&d.addEventListener("click",function(b){b.preventDefault();const m=new URLSearchParams({action:"nuclen_dismiss_pointer",pointer:e.id});l&&m.append("nonce",l),(async()=>{try{const f=await g(n,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:m.toString()});f.ok||(h("Failed to dismiss pointer:",f.error),u("Failed to dismiss pointer."))}catch(f){h("Error dismissing pointer:",f),u("Network error while dismissing pointer.")}t.remove(),p++,s()})()})}document.addEventListener("DOMContentLoaded",s)}y()})();
